{% extends "base.html" %}
{% load i18n %}
{% block title %}
    {% blocktrans with viewing.name as name %} Group / {{ name }} {% endblocktrans %}
{% endblock %}

{% block content %}
    <h2>
        <div class="left"><img src="{% groupavatar viewing 32 %}" alt="{{ viewing.name }}"/></div>
        {% blocktrans with viewing.name as name %} Group / {{ name }} {% endblocktrans %}
        <div class="clear"></div>
    </h2>

    <div id="subcontent">
        <div class="buttons">
            {% if editable %}
                <span class="button"><a class="button" href="{% url edit_group viewing.name %}">{% trans "Edit" %}</a></span>
                <span class="button"><a class="button" href="{% url edit_group_members viewing.name %}">{% trans "Edit members" %}</a></span>
            {% endif %}
            {% if member %}
                <form method="POST" action="{% url leave_group viewing.name %}"> {% csrf_token %}
                    <span class="button"><input class="link" type="submit" value="Leave"/></span>
                </form>
            {% else %}
                <form method="POST" action="{% url join_group viewing.name %}"> {% csrf_token %}
                    <span class="button"><input class="link" type="submit" value="Join"/></span>
                </form>
            {% endif %}
        </div>

        <div id="profile">
            <div id="profileimg">
                <img src="{% groupavatar viewing 128 %}" alt="{{ viewing.name }}"/>
                <div id="thumbtack"></div>
            </div>
            <span class="location"><a href="{% url groups %}?search={{ viewing.location }}">{{ viewing.location }}</a></span>
            <span class="username">{{ viewing.name }}</span>
            <a href="{{ viewing.web }}" class="web">{{ viewing.web }}</a>
            <p class="description">{{ viewing.description }}</p>
        </div>
        <div class="clear"></div>

        <div id="memberlist">
        <h3>
            {% trans "Members" %}
            {% if editable and requests %}
                (<a href="{% url edit_group_members viewing.name %}">{{ requests }} {% trans "pending requests" %}</a>)
            {% endif %}
        </h3>
        {% for membership in memberships %}
            <a href="{% url view_profile membership.user.username %}">
            <img class="left
                        {% if membership.role == "ADM" %}admin{% endif %}
                        {% if membership.user == USER %}me{% endif %}"
                 src="{% avatar membership.user 64 %}"
                 title="{{ membership.user.get_profile.name }}"
                 alt="{{ membership.user.username }}"/>
            </a>
        {% endfor %}
        </div>

        <!-- wall --!>
        <div id="groupwall">
            {% with wall=wall wallmessages=wallmessages%}
                {% include "truekko/wall.html" %}
            {% endwith %}
        </div>

        <div class="clear"></div>
    </div>

    {% with pagination=wallmessages %}
        {% include "paginate.html" %}
    {% endwith %}
{% endblock %}
